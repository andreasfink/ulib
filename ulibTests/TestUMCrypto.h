//
//  TestUMCrypto.h
//  ulib
//
//  Created by Aarno Syvänen on 27.08.12.
//
//
/*
 *  test_crypto.c
 *  mms-mm7
 *
 *  Run test cases for cryptographic algorithms. 
 *
 *  Created by Aarno Syvänen on 13/11/09.
 *  //  Copyright © 2017 Andreas Fink (andreas@fink.org). All rights reserved.
 *
 */
/* For DES
 test_case = 1
 key = 0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
 key_len = 16
 data = "Hi There"
 data_len = 8
 
 test_case = 2
 key = "Jefe"
 key_len = 4
 data = "what do ya want for nothing?"
 data_len = 28
 
 test_case = 3
 key = 0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
 key_len = 16
 data = 0xdd repeated 50 times
 data_len = 50
 
 test_case = 4
 key = 0x0102030405060708090a0b0c0d0e0f10111213141516171819
 key_len = 25
 data = 0xcd repeated 50 times
 data_len = 50
 
 test_case = 5
 key = 0x0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c
 key_len = 16
 data = "Test With Truncation"
 data_len = 20
 
 test_case = 6
 key = 0xaa repeated 80 times
 key_len = 80
 data = "Test Using Larger Than Block-Size Key"
 data_len = 54
 
 test_case = 7
 key = 0xaa repeated 80 times
 key_len = 80
 data = "Test Using Larger Than Block-Size Key and Larger
 Than One Block-Size Data"
 data_len = 73
 */

unsigned char test_key1[16]={0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b,
    0x0b, 0x0b, 0x0b, 0x0b, 0x0b};
unsigned char test_data1[9]={"Hi There"};
unsigned char test_key2[5]={"Jefe"};
unsigned char test_data2[29]={"what do ya want for nothing?"};
unsigned char test_key3[25]={0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,
    0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,
    0xa,0xa,0xa,0xa,0xa};
unsigned char test_data3[50]={0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,
    0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,
    0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,
    0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,
    0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd};
unsigned char test_key4[25]={0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,
    0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,
    0x15,0x16,0x17,0x18,0x19};
unsigned char test_data4[50]={0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,
    0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,
    0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,
    0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,
    0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd};
unsigned char test_key5[16]={0xc,0xc,0xc,0xc,0xc,0xc,0xc,0xc,0xc,0xc,
    0xc,0xc,0xc,0xc,0xc,0xc};
unsigned char test_data5[21]={"Test With Truncation"};
unsigned char test_key6[80]={0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
    0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
    0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
    0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
    0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
    0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
    0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
    0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa};
unsigned char test_data6[55]={"Test Using Larger Than Block-Size Key - Hash Key First"};
unsigned char test_data7[74]={"Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data"};

unsigned char test_key8[16]={0x12,0x34,0x56,0x78,0x9a,0xbc,0xde,0xf0,
    0x24,0x68,0xac,0xe0,0x13,0x57,0x9b,0xdf};
unsigned char test_data8[108]={0x45, 0x00, 0x00, 0x6c, 0x00, 0x33, 0x00, 0x00,
    0x00, 0x33, 0x00, 0x00, 0xc0, 0xa8, 0x00, 0x01,
    0xc0, 0xa8, 0x00, 0x02, 0x01, 0x04, 0x00, 0x00,
    0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x03,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x60, 0xc8,
    0x1a, 0x0b, 0x00, 0x01, 0xc3, 0x0e, 0x07, 0x40,
    0xc2, 0xd9, 0x05, 0x00, 0x08, 0x09, 0x0a, 0x0b,
    0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13,
    0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b,
    0x1c, 0x1d, 0x1e, 0x1f, 0x20, 0x21, 0x22, 0x23,
    0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2a, 0x2b,
    0x2c, 0x2d, 0x2e, 0x2f, 0x30, 0x31, 0x32, 0x33,
    0x34, 0x35, 0x36, 0x37};

typedef struct {
    unsigned char *key;
    unsigned char key_len;
    unsigned char *data;
    unsigned char data_len;
} DES_TEST;

/* \0 at the end of the string excluded*/
DES_TEST des_test[8] = {
    {test_key1, sizeof(test_key1), test_data1, sizeof(test_data1)-1},
    {test_key2, sizeof(test_key2)-1, test_data2, sizeof(test_data2)-1},
    {test_key3, sizeof(test_key3), test_data3, sizeof(test_data3)},
    {test_key4, sizeof(test_key4), test_data4, sizeof(test_data4)},
    {test_key5, sizeof(test_key5), test_data5, sizeof(test_data5)-1},
    {test_key6, sizeof(test_key6), test_data6, sizeof(test_data6)-1},
    {test_key6, sizeof(test_key6), test_data7, sizeof(test_data7)-1},
    {test_key8, sizeof(test_key8), test_data8, sizeof(test_data8)}
};


#import <XCTest/XCTest.h>

@interface TestUMCrypto : XCTestCase

+ (void)displayMemHex:(NSData *) pData withSize:(unsigned int)size withColumn:(unsigned char)outputWidth;

@end
